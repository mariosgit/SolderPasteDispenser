var t={};!function(){var e={};function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e,n){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"gray",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"16px Monospace",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;i(this,t),this.x=a,this.y=r,this.ctx=e,this.canvas=n,this.color=s,this.font=o,this.setPos=this.setPos.bind(this)}return function(t,e,i){e&&n(t.prototype,e),i&&n(t,i)}(t,[{key:"track",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.canvas;return t?e.addEventListener("mousemove",this.setPos):e.removeEventListener("mousemove",this.setPos),this}},{key:"setPos",value:function(t){var e=this.canvas.getBoundingClientRect();return this.x=Math.floor(t.clientX-e.left),this.y=Math.floor(t.clientY-e.top),this}},{key:"draw",value:function(){var t=this.x,e=this.y,i=this.canvas,n=this.ctx,s=this.font,o=this.color,a="X: ".concat(t,", Y: ").concat(e);n.save(),n.fillStyle=o,n.font=s;var r=t<i.width/2?20:-n.measureText(a).width-20,l=e<i.height/2?25:-18;return n.fillText(a,this.x+r,this.y+l),n.restore(),this}}]),t}();function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}var l=function(){function t(e,i,n,s,a,r){o(this,t),this.color=e,this.lineWidth=i,this.startX=n,this.startY=s,this.endX=a,this.endY=r}return r(t,[{key:"draw",value:function(t){var e=this.color,i=this.lineWidth,n=this.startX,s=this.startY,o=this.endX,a=this.endY;t.save(),t.beginPath(),t.strokeStyle=e,t.lineWidth=i,t.moveTo(n,s),t.lineTo(o,a),t.stroke(),t.restore()}}]),t}(),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gray",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"DarkGray",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"16px Monospace";o(this,t),this.color=e,this.lineWidth=i,this.step=n,this.boldNth=s,this.boldColor=a,this.boldWidth=r,this.font=l,this.lines=null}return r(t,[{key:"createLines",value:function(t){for(var e=this.color,i=this.lineWidth,n=this.step,s=this.boldNth,o=this.boldColor,a=this.boldWidth,r=[],h=s*n,d=0;d<t.width;d+=n){var c=d%h==0;r.push(c?new l(o,a,d,0,d,t.height):new l(e,i,d,0,d,t.height))}for(var f=0;f<t.height;f+=n){var u=f%h==0;r.push(u?new l(o,a,0,f,t.width,f):new l(e,i,0,f,t.width,f))}this.lines=r}},{key:"drawText",value:function(t,e){var i=this.step,n=this.boldNth,s=this.boldColor,o=this.font;t.save(),t.font=o,t.fillStyle=s,t.fillText("0",1,15);for(var a=i*n;a<e.width;a+=i*n)t.fillText(a,a,15);for(var r=i*n;r<e.height;r+=i*n)t.fillText(r,0,r+15);t.restore()}},{key:"draw",value:function(t,e){this.lines||this.createLines(e),this.lines.forEach((function(e){return e.draw(t)})),this.drawText(t,e)}}]),t}();e.Mouse=s,e.Grid=h,t=e}();const e=document.getElementsByTagName("body")[0],i=document.getElementById("fileInput"),n=document.getElementById("uploadButton"),s=document.getElementById("padsField"),o=document.getElementById("coordsField"),a=document.getElementById("canvas");let r,l,h,d=null;class c{constructor(t,e){this.width=t,this.height=e}}class f{constructor(t,e,i){this.posX=e,this.posY=i,this.style=t}}class u{zoom=6;constructor(t,e){this.ctx=t,this.canvas=e,this.mapStyles=new Map,this.mapPads=new Map}draw(){this.ctx.fillStyle="antiquewhite",this.ctx.beginPath();for(let t of this.mapPads.keys()){const e=this.mapStyles.get(t),i=this.mapPads.get(t);if(e&&i){const t=e.width*this.zoom,n=e.height*this.zoom;for(let e of i.values())this.ctx.fillRect(e.posX*this.zoom-t/2,e.posY*this.zoom-n/2,t,n)}}this.ctx.fill()}addPadStyle(t,e,i){this.mapStyles.set(t,new c(e,i))}addPad(t,e,i){this.mapPads.has(t)||this.mapPads.set(t,new Set);let n=this.mapPads.get(t);n&&n.add(new f(t,e,i))}}function g(){a&&d&&(window.requestAnimationFrame(g),d.clearRect(0,0,a.width,a.height),l.draw(d,a),r.draw(),h.draw())}function v(t){i&&n&&s&&o&&e&&d&&t.arrayBuffer().then((t=>{var e,i,n,a;e="UTF-8",i=t=>{console.log(t);const e=(t=t.replace(/\r/g,"")).split("\n");let i=1,n=1,a="";for(let t of e){const e=t.match(/^%FSLAX([0-9])([0-9])Y([0-9])([0-9])[*]%/);e&&(n=parseInt(e[1]),i=parseInt(e[2]),console.log(`float digits = ${n} ${i}`));const r=t.match(/^(%AD)(D[0-9]+)([A-Za-z])[,]([0-9.]+)[X]([0-9.]+)/);r&&(s.innerHTML+=`${r[2]} ${r[4]} ${r[5]}<br>`,h.addPadStyle(r[2],parseFloat(r[4]),parseFloat(r[5])));const l=t.match(/^X([0-9]+)Y([0-9]+)D([0-9]+)[*]/),d=t.match(/^(D[0-9]+)[*]/);if(d&&(a=d[1]),l){let t=l[1],e=l[2];const s=n+i;for(;t.length<s;)t=`0${t}`;for(;e.length<s;)e=`0${e}`;let r=0,d=0;t=`${t.substring(0,n)}.${t.substring(n)}`,e=`${e.substring(0,n)}.${e.substring(n)}`,r=parseFloat(t),d=parseFloat(e),o.innerHTML+=`${a}:  x:${r} y:${d} <br>`,h.addPad(a,r,d)}}},n=new Blob([t],{type:"text/plain"}),(a=new FileReader).onload=t=>{i(t.target.result)},a.readAsText(n,e)}))}document.addEventListener("DOMContentLoaded",(function(){console.log("moinsen"),i&&n&&s&&o&&e&&a?(d=a.getContext("2d"),h=new u(d,a),n.onclick=()=>{if(i.files&&i.files.length>0){let t=i.files[0];console.log(t),console.log(`file: ${t.name} size:${t.size}`),v(t)}else alert("please choose a file")},e.ondrop=t=>{t.preventDefault(),console.log(t),t.dataTransfer.items?[...t.dataTransfer.items].forEach(((t,e)=>{if("file"===t.kind){const i=t.getAsFile();i&&(console.log(`… item[${e}].name = ${i.name}`),v(i))}})):[...t.dataTransfer.files].forEach(((t,e)=>{t&&(console.log(`… file[${e}].name = ${t.name}`),v(t))}))},e.ondragover=t=>{console.log("File(s) in drop zone"),t.preventDefault()},a.width=innerWidth,a.height=innerWidth,r=new(0,t.Mouse)(d,a),r.track(),l=new(0,t.Grid),window.requestAnimationFrame(g)):console.error("missing html elements !")})),window.addEventListener("resize",(t=>{console.log(`resize: ${t}`),a&&(a.width=innerWidth,a.height=innerWidth,r.draw(),l.draw(d,a))}));
//# sourceMappingURL=index.7f2d5a01.js.map
