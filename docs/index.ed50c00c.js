var t={};!function(){var e={};function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var o=function(){function t(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"gray",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"16px Monospace",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;s(this,t),this.x=a,this.y=r,this.ctx=e,this.canvas=i,this.color=o,this.font=n,this.setPos=this.setPos.bind(this)}return function(t,e,s){e&&i(t.prototype,e),s&&i(t,s)}(t,[{key:"track",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.canvas;return t?e.addEventListener("mousemove",this.setPos):e.removeEventListener("mousemove",this.setPos),this}},{key:"setPos",value:function(t){var e=this.canvas.getBoundingClientRect();return this.x=Math.floor(t.clientX-e.left),this.y=Math.floor(t.clientY-e.top),this}},{key:"draw",value:function(){var t=this.x,e=this.y,s=this.canvas,i=this.ctx,o=this.font,n=this.color,a="X: ".concat(t,", Y: ").concat(e);i.save(),i.fillStyle=n,i.font=o;var r=t<s.width/2?20:-i.measureText(a).width-20,l=e<s.height/2?25:-18;return i.fillText(a,this.x+r,this.y+l),i.restore(),this}}]),t}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,s){return e&&a(t.prototype,e),s&&a(t,s),t}var l=function(){function t(e,s,i,o,a,r){n(this,t),this.color=e,this.lineWidth=s,this.startX=i,this.startY=o,this.endX=a,this.endY=r}return r(t,[{key:"draw",value:function(t){var e=this.color,s=this.lineWidth,i=this.startX,o=this.startY,n=this.endX,a=this.endY;t.save(),t.beginPath(),t.strokeStyle=e,t.lineWidth=s,t.moveTo(i,o),t.lineTo(n,a),t.stroke(),t.restore()}}]),t}(),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gray",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.3,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"DarkGray",r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.5,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"16px Monospace";n(this,t),this.color=e,this.lineWidth=s,this.step=i,this.boldNth=o,this.boldColor=a,this.boldWidth=r,this.font=l,this.lines=null}return r(t,[{key:"createLines",value:function(t){for(var e=this.color,s=this.lineWidth,i=this.step,o=this.boldNth,n=this.boldColor,a=this.boldWidth,r=[],h=o*i,d=0;d<t.width;d+=i){var c=d%h==0;r.push(c?new l(n,a,d,0,d,t.height):new l(e,s,d,0,d,t.height))}for(var u=0;u<t.height;u+=i){var f=u%h==0;r.push(f?new l(n,a,0,u,t.width,u):new l(e,s,0,u,t.width,u))}this.lines=r}},{key:"drawText",value:function(t,e){var s=this.step,i=this.boldNth,o=this.boldColor,n=this.font;t.save(),t.font=n,t.fillStyle=o,t.fillText("0",1,15);for(var a=s*i;a<e.width;a+=s*i)t.fillText(a,a,15);for(var r=s*i;r<e.height;r+=s*i)t.fillText(r,0,r+15);t.restore()}},{key:"draw",value:function(t,e){this.lines||this.createLines(e),this.lines.forEach((function(e){return e.draw(t)})),this.drawText(t,e)}}]),t}();e.Mouse=o,e.Grid=h,t=e}();const e=document.getElementsByTagName("body")[0],s=document.getElementById("fileInput"),i=document.getElementById("uploadButton"),o=document.getElementById("padsField"),n=document.getElementById("coordsField"),a=document.getElementById("dropZone"),r=document.getElementById("canvas");let l,h,d,c=null;class u{constructor(t,e){this.width=t,this.height=e}}class f{constructor(t,e,s){this.posX=e,this.posY=s,this.style=t}}class m{fileName="";mouseFlag=!1;mouseStartX=0;mouseStartY=0;mouseOffX=0;mouseOffY=0;zoom=6;constructor(t,e){this.ctx=t,this.canvas=e,this.mapStyles=new Map,this.mapPads=new Map}draw(){this.ctx.fillStyle="antiquewhite",this.ctx.beginPath();for(let t of this.mapPads.keys()){const e=this.mapStyles.get(t),s=this.mapPads.get(t);if(e&&s){const t=e.width*this.zoom,i=e.height*this.zoom;for(let e of s.values())this.ctx.fillRect(e.posX*this.zoom-t/2+this.mouseOffX,e.posY*this.zoom-i/2+this.mouseOffY,t,i)}}this.ctx.fill()}addPadStyle(t,e,s){this.mapStyles.set(t,new u(e,s))}addPad(t,e,s){this.mapPads.has(t)||this.mapPads.set(t,new Set);let i=this.mapPads.get(t);i&&i.add(new f(t,e,s))}mouseDown(t){this.mouseStartX=t.clientX-this.mouseOffX,this.mouseStartY=t.clientY-this.mouseOffY,this.mouseFlag=!0}mouseUp(t){this.mouseFlag=!1}mouseMove(t){this.mouseFlag&&(this.mouseOffX=t.clientX-this.mouseStartX,this.mouseOffY=t.clientY-this.mouseStartY)}mouseWheel(t){console.log(t.deltaY),t.deltaY>0?this.zoom*=1.1:this.zoom*=.9}}function v(){r&&c&&(window.requestAnimationFrame(v),c.clearRect(0,0,r.width,r.height),h.draw(c,r),l.draw(),d&&d.draw())}function g(t){s&&i&&o&&n&&e&&c&&t.arrayBuffer().then((e=>{var s,i,l,h;s="UTF-8",i=e=>{d=new m(c,r),a&&(a.innerText=t.name);const s=(e=e.replace(/\r/g,"")).split("\n");let i=1,l=1,h="";for(let t of s){const e=t.match(/^%FSLAX([0-9])([0-9])Y([0-9])([0-9])[*]%/);e&&(l=parseInt(e[1]),i=parseInt(e[2]),console.log(`float digits = ${l} ${i}`));const s=t.match(/^(%AD)(D[0-9]+)([A-Za-z])[,]([0-9.]+)[X]([0-9.]+)/);s&&(o.innerHTML+=`${s[2]} ${s[4]} ${s[5]}<br>`,d.addPadStyle(s[2],parseFloat(s[4]),parseFloat(s[5])));const a=t.match(/^X([0-9]+)Y([0-9]+)D([0-9]+)[*]/),r=t.match(/^(D[0-9]+)[*]/);if(r&&(h=r[1]),a){let t=a[1],e=a[2];const s=l+i;for(;t.length<s;)t=`0${t}`;for(;e.length<s;)e=`0${e}`;let o=0,r=0;t=`${t.substring(0,l)}.${t.substring(l)}`,e=`${e.substring(0,l)}.${e.substring(l)}`,o=parseFloat(t),r=parseFloat(e),n.innerHTML+=`${h}:  x:${o} y:${r} <br>`,d.addPad(h,o,r)}}},l=new Blob([e],{type:"text/plain"}),(h=new FileReader).onload=t=>{i(t.target.result)},h.readAsText(l,s)}))}document.addEventListener("DOMContentLoaded",(function(){console.log("moinsen"),s&&i&&o&&n&&e&&r?(c=r.getContext("2d"),r.addEventListener("mousemove",(t=>{d&&d.mouseMove(t)}),!1),r.addEventListener("mousedown",(t=>{d&&d.mouseDown(t)}),!1),r.addEventListener("mouseup",(t=>{d&&d.mouseUp(t)}),!1),r.addEventListener("mouseout",(t=>{d&&d.mouseUp(t)}),!1),r.addEventListener("wheel",(t=>{d&&d.mouseWheel(t)}),!1),i.onclick=()=>{if(s.files&&s.files.length>0){let t=s.files[0];console.log(t),console.log(`file: ${t.name} size:${t.size}`),g(t)}else alert("please choose a file")},e.ondrop=t=>{t.preventDefault(),console.log(t),t.dataTransfer.items?[...t.dataTransfer.items].forEach(((t,e)=>{if("file"===t.kind){const s=t.getAsFile();s&&(console.log(`… item[${e}].name = ${s.name}`),g(s))}})):[...t.dataTransfer.files].forEach(((t,e)=>{t&&(console.log(`… file[${e}].name = ${t.name}`),g(t))}))},e.ondragover=t=>{console.log("File(s) in drop zone"),t.preventDefault()},r.width=innerWidth,r.height=innerWidth,l=new(0,t.Mouse)(c,r),l.track(),h=new(0,t.Grid),window.requestAnimationFrame(v)):console.error("missing html elements !")})),window.addEventListener("resize",(t=>{console.log(`resize: ${t}`),r&&(r.width=innerWidth,r.height=innerWidth,l.draw(),h.draw(c,r))}));
//# sourceMappingURL=index.ed50c00c.js.map
